<!DOCTYPE html>
<html lang="in">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kanalisasi Pajitex</title>
<!-- SweetAlert -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- Email.js SDK -->
<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<!-- CSS -->
<link rel="stylesheet" href="style.css">
</head>
<body>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
        overflow-y: hidden; /* Hide vertical scrollbar */
        overflow-x: hidden; /* Hide horizontal scrollbar */
    }
    .container {
        max-width: 500px;
        margin: 50px auto;
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
    }
    h2 {
        text-align: center;
        margin-bottom: 20px;
    }
    .form-group {
        margin-bottom: 20px;
    }
    .form-group label {
        display: block;
        font-weight: bold;
    }
    .form-group select,
    .form-group input[type="email"],
    .form-group textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }
    .form-group textarea {
        height: 150px;
        resize: vertical;
        overflow-y: auto;
    }
    .form-group textarea::-webkit-scrollbar {
        width: 5px;
    }
    .form-group textarea::-webkit-scrollbar-thumb {
        background-color: #888;
        border-radius: 10px;
    }
    .form-group textarea::-webkit-scrollbar-thumb:hover {
        background-color: #555;
    }
    .form-group button {
        background-color: #4CAF50;
        color: #fff;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
    }
    .form-group button:hover {
        background-color: #45a049;
    }
</style>
<div class="container">
    <h2>PT. Panggung Jaya Indah Textile</h2>
    <form id="kanalisasiForm">
        <div class="form-group">
            <label for="subject">Kategori:</label>
            <select id="subject" name="subject" required>
                <option value="" disabled selected>Pilih Kategori</option>
                <option value="Saran">Saran</option>
                <option value="Keluhan">Keluhan</option>
                <option value="Pesan">Pesan</option>
            </select>
        </div>
        <div class="form-group">
            <label for="pesan">Pesan:</label>
            <textarea id="pesan" name="pesan" placeholder="Tulis penyampaian Anda di sini..." required></textarea>
        </div>
        <div class="form-group">
            <label for="email">Email Anda:</label>
            <input type="email" id="email" name="email" placeholder="Opsional, untuk informasi tindak lanjut">
        </div>
        <div class="form-group">
            <button type="submit">Kirim <span id="categoryButton">Pesan</span></button>
        </div>
    </form>
</div>

<script>
// Inisialisasi Email.js dengan user ID Anda
const userIds = [
    'USER_ID_1',
    'USER_ID_2',
    'USER_ID_3',
    'USER_ID_4',
    'USER_ID_5',
    'USER_ID_6',
    'USER_ID_7',
    'USER_ID_8',
    'USER_ID_9',
    'USER_ID_10',
    'USER_ID_11',
    'USER_ID_12',
    'USER_ID_13',
    'USER_ID_14',
    'USER_ID_15',
    'USER_ID_16'
];

const serviceIds = [
    'SERVICE_ID_1',
    'SERVICE_ID_2',
    'SERVICE_ID_3',
    'SERVICE_ID_4',
    'SERVICE_ID_5',
    'SERVICE_ID_6',
    'SERVICE_ID_7',
    'SERVICE_ID_8',
    'SERVICE_ID_9',
    'SERVICE_ID_10',
    'SERVICE_ID_11',
    'SERVICE_ID_12',
    'SERVICE_ID_13',
    'SERVICE_ID_14',
    'SERVICE_ID_15',
    'SERVICE_ID_16'
];

const templateIds = [
    'TEMPLATE_ID_1',
    'TEMPLATE_ID_2',
    'TEMPLATE_ID_3',
    'TEMPLATE_ID_4',
    'TEMPLATE_ID_5',
    'TEMPLATE_ID_6',
    'TEMPLATE_ID_7',
    'TEMPLATE_ID_8',
    'TEMPLATE_ID_9',
    'TEMPLATE_ID_10',
    'TEMPLATE_ID_11',
    'TEMPLATE_ID_12',
    'TEMPLATE_ID_13',
    'TEMPLATE_ID_14',
    'TEMPLATE_ID_15',
    'TEMPLATE_ID_16'
];

// Mendapatkan hari saat ini untuk menentukan user, service, dan template ID
const today = new Date();
const dayOfMonth = today.getDate();
const isLongMonth = [1, 3, 5, 7, 8, 10, 12].includes(today.getMonth() + 1); // Bulan yang memiliki 31 hari

// Mengatur User ID, Service ID, dan Template ID
const userId = (dayOfMonth <= 15) ? userIds[0] : userIds[dayOfMonth - 16];
const serviceId = (dayOfMonth <= 15) ? serviceIds[0] : serviceIds[dayOfMonth - 16];
const templateId = (dayOfMonth <= 15) ? templateIds[0] : templateIds[dayOfMonth - 16];

// Inisialisasi Email.js dengan user ID yang dipilih
emailjs.init(userId);

// Fungsi untuk mengubah label tombol berdasarkan kategori
document.getElementById('subject').addEventListener('change', function () {
    const category = this.value;
    const button = document.querySelector('button[type="submit"]');
    const categoryButton = document.getElementById('categoryButton');
    
    if (category === 'Saran') {
        categoryButton.textContent = 'Saran';
        button.style.backgroundColor = '#4CAF50';
    } else if (category === 'Keluhan') {
        categoryButton.textContent = 'Keluhan';
        button.style.color = '#000000';
        button.style.backgroundColor = '#FFD700';
    } else if (category === 'Pesan') {
        categoryButton.textContent = 'Pesan';
        button.style.backgroundColor = '#1E90FF';
    }
});

// Fungsi yang akan dipanggil saat formulir dikirim
document.getElementById('kanalisasiForm').addEventListener('submit', function (event) {
    event.preventDefault();

    // Ambil nilai dari setiap input formulir
    const email = document.getElementById('email').value;
    const pesan = document.getElementById('pesan').value;
    const subject = document.getElementById('subject').value;

    // Periksa apakah pengguna mengisi email atau tidak
    if (!email) {
        Swal.fire({
            title: 'Apakah Anda yakin?',
            text: `Jika tidak mengisi email, Anda tidak mendapatkan informasi tindak lanjut dari ${subject} Anda.`,
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Ya, kirim saja!',
            cancelButtonText: 'Batal',
        }).then((result) => {
            if (result.isConfirmed) {
                // Lanjutkan untuk mengirim pesan
                kirimPesan(email, pesan, subject);
            }
        });
    } else {
        // Lanjutkan untuk mengirim pesan
        kirimPesan(email, pesan, subject);
    }
});

// Fungsi untuk mendapatkan salam berdasarkan waktu
function getSalam() {
    const sekarang = new Date();
    const jam = sekarang.getHours();

    let salam = "Assalamualaikum, selamat ";
    if (jam < 12) {
        salam += "pagi";
    } else if (jam < 15) {
        salam += "siang";
    } else if (jam < 18) {
        salam += "sore";
    } else {
        salam += "malam";
    }

    return salam;
}

// Fungsi untuk mengirim pesan melalui Email.js
function kirimPesan(email, pesan, subject) {
    // Buat salam berdasarkan waktu saat ini
    const salam = getSalam();

    // Buat objek data untuk dikirim ke Email.js
    const data = {
        subject: subject,
        pesan: pesan,
        email: email,
        pajitex: 'account@pajitex.com',
        isi: `<!DOCTYPE html>
<html lang="in">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanalisasi PT. Panggung Jaya Indah Textile</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 text-gray-800">
    <header class="bg-white shadow">
        <div class="max-w-7xl mx-auto px-4 py-6 flex justify-between items-center">
            <img src="pajitex.png" alt="Logo" class="h-12">
            <nav class="space-x-4">
                <a href="#" class="text-gray-600 hover:text-gray-800">HRD Pajitex</a>
                <!-- <a href="#" class="text-gray-600 hover:text-gray-800">About Us</a>
                <a href="#" class="text-gray-600 hover:text-gray-800">Contact</a> -->
            </nav>
        </div>
    </header>
    
    <main class="my-10">
        <div class="max-w-3xl mx-auto bg-white rounded-lg shadow-md p-6">
            <h1 class="text-2xl font-bold mb-4">Ada {{subject}} dari karyawan</h1>
            <p class="mb-4">{{salam}},</p>
            <blockquote class="border-l-4 border-gray-400 pl-4 italic mb-4">
                {{pesan}}
            </blockquote>
            <p class="mb-4">Email Karyawan : {{email}}</p>
            <p class="mb-4">Semoga ada tindak lanjut. Terima kasih atas waktunya!</p>
        </div>
    </main>

    <footer class="bg-gray-800 text-white py-6">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p>&copy; 2024 PT. Panggung Jaya Indah Textile. All rights reserved.</p>
            <p>Alamat: Jl. Watusalam No. 123, Kota pekalongan, Jawa Tengah</p>
            <p>Email: mail.banggabersarung.com | Telepon: (021) 123-4567</p>
        </div>
    </footer>
</body>
</html>
`
    };

    // Kirim data melalui Email.js
    emailjs.send(serviceId, templateId, data)
        .then(response => {
            console.log(`${subject} terkirim dengan sukses:`, response);
            Swal.fire({
                icon: 'success',
                title: `${subject} Terkirim!`,
                text: `Terima kasih atas ${subject} Anda.`,
                confirmButtonColor: '#4070f4'
            });
        })
        .catch(error => {
            console.error(`Error saat mengirim ${subject}:`, error);
            Swal.fire({
                icon: 'error',
                title: `${subject} Gagal`,
                text: `Gagal mengirim ${subject}. Silakan coba lagi nanti.`,
                confirmButtonColor: '#4070f4'
            });
        });
}
</script>
</body>
</html>
